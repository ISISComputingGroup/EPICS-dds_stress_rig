record(ai, "$(P)ELONG") {
    field(DESC, "Elongation read from array")
    field(INP, "$(P)ARRAY.[2] CP MS")
    field(EGU, "um")
}

record(ai, "$(P)LOAD") {
    field(DESC, "Load read from array")
    field(INP, "$(P)ARRAY.[1] CP MS")
    field(EGU, "N")
}

record(ao, "$(P)LOAD:SP") {
    field(DESC, "Set-point for load")
    field(EGU, "N")
}

record(ai, "$(P)TIME") {
    field(DESC, "Time read from Array")
    field(INP, "$(P)ARRAY.[0] CP MS")
}

record(calc, "$(P)MOT:ACTIV") {
    field(DESC, "Motor Moving")
    field(CALC, "a!=0")
    field(INPA, "$(P)MOT:STAT CP MS")
}

record(seq, "$(P)CHANGE_SPEED"){
    field(DESC, "Command Sequence to set Speed.")
    field(DO0, "1")
    field(LNK0, "$(P)MODE:SPEED:SP PP")
    field(DO1, "0")
    field(LNK1, "$(P)CONTROL:SPEED:SP PP")
    field(DO2, "0")
    field(LNK2, "$(P)DIRECTION:SPEED:SP PP")
    field(DOL3, "$(P)SPEED:SP")
    field(LNK3, "$(P)_SPEED:SP PP")
    field(DO4, "1")
    field(LNK4, "$(P)SPEED:SET:SP PP")
    field(DO5, "2")
    field(LNK5, "$(P)DIRECTION:SPEED:SP PP")
    field(DLY5, "0.2")
    field(DO6, "1")
    field(LNK6, "$(P)SPEED:SET:SP PP")
    field(DLY6, "0.2")
    field(SCAN, "Passive")
    field(SELM, "All")
}

record(ao, "$(P)SPEED:SP") {
    field(DESC, "Target Speed")
}

record(bo, "$(P)START"){
    field(DESC, "Command Sequence to request a Start.")
}

record(bo, "$(P)_START_SEQ_ONGOING"){
    field(DESC, "Used to calc when to continue start SEQ")
}

record(calcout, "$(P)_START_CHANNEL_ELONG"){
    field(DESC, "Ensure channel is Elong before contuing")
    field(CALC, "(A=2)&&(B=1)")
    field(INPA, "$(P)TRGT CP MS")
    field(INPB, "$(P)ELONG CP MS")
}

record(ao, "$(P)TRGT") {
    field(DESC, "Target Value")
    field(EGU, "um")
}

record(calc, "$(P)_START_LIMIT") {
    field(DESC, "Start sequence limit mask")
    field(CALC, "a>b?13823:15103")
    field(INPA, "$(P)TRGT CP MS")
    field(INPB, "$(P)ELONG CP MS")
}

record(bo, "$(P)SET_LOAD"){
    field(DESC, "Command Sequence to set a load.")
}

record(mbbo, "$(P)STATEMACHINE:STATE") {
    field(ZRST, "neutral")
    field(ONST, "stopDelay")
    field(TWST, "clearLimit")
    field(THST, "s1")
    field(FRST, "l1")
	field(FVST, "resetLimit")
    field(SXST, "s2")
    field(SVST, "l2")
    field(EIST, "startGreater")
    field(NIST, "startLesser")
    field(TEST, "startState")
    field(ELST, "l3")
	
	info(archive, "VAL")
}
